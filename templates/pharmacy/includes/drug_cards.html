
{% if drugs %}
<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 row-cols-xl-4 g-4">
    {% for drug in drugs %}
    <div class="col">
        <div class="card h-100 border-0 shadow-sm drug-card">
            <div class="card-img-top text-center p-3" style="height: 180px; background-color: #f8f9fa;">
                <div class="d-flex align-items-center justify-content-center h-100">
                    <i class="fas fa-pills fa-4x text-muted"></i>
                </div>
            </div>
            <div class="card-body">
                <h5 class="card-title mb-1">{{ drug.name }}</h5>
                <p class="text-muted small mb-1">
                    {% if drug.generic_name %}
                    {{ drug.generic_name }}
                    {% endif %}
                </p>
                <p class="text-muted small mb-2">
                    <i class="bi bi-tag-fill me-1"></i>
                    {% if drug.category %}
                    {{ drug.category.name }}
                    {% else %}
                    No category
                    {% endif %}
                </p>
                
                <div class="mb-2">
                    <span class="badge bg-secondary">{{ drug.get_form_display }}</span>
                    {% if drug.strength %}
                    <span class="badge bg-info">{{ drug.strength }}</span>
                    {% endif %}
                </div>
                
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="badge {% if drug.needs_reorder %}bg-danger{% elif drug.current_stock == 0 %}bg-dark{% else %}bg-success{% endif %}">
                        {% if drug.current_stock == 0 %}
                            Out of Stock
                        {% elif drug.needs_reorder %}
                            Low Stock: {{ drug.current_stock }}
                        {% else %}
                            {{ drug.current_stock }} in stock
                        {% endif %}
                    </span>
                    <span class="text-primary fw-bold">
                        KSh {{ drug.unit_price }}
                    </span>
                </div>
                
                {% if drug.requires_prescription %}
                <div class="mb-2">
                    <small class="text-warning">
                        <i class="bi bi-exclamation-triangle-fill me-1"></i>
                        Prescription Required
                    </small>
                </div>
                {% endif %}
                
                <div class="d-flex justify-content-between gap-1">
                    <button class="btn btn-sm btn-outline-primary view-drug flex-fill" 
                            data-id="{{ drug.id }}"
                            data-bs-toggle="modal" 
                            data-bs-target="#drugDetailModal">
                        <i class="bi bi-eye me-1"></i> View
                    </button>
                    <button class="btn btn-sm btn-outline-secondary edit-drug flex-fill" 
                            data-id="{{ drug.id }}"
                            data-bs-toggle="modal" 
                            data-bs-target="#editDrugModal">
                        <i class="bi bi-pencil me-1"></i> Edit
                    </button>
                    <button class="btn btn-sm btn-outline-danger delete-drug" 
                            data-id="{{ drug.id }}"
                            data-url="{% url 'drug-delete' drug.pk %}">
                        <i class="bi bi-trash"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="text-center py-5">
    <i class="fas fa-pills fa-4x text-muted mb-3"></i>
    <h5 class="text-muted">No drugs found</h5>
    <p class="text-muted">
        {% if search_query %}
        No drugs match your search criteria
        {% else %}
        Get started by adding your first drug to the inventory
        {% endif %}
    </p>
</div>
{% endif %}